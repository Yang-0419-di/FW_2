{% extends "layout.html" %}

{% block content %}
<div style="max-width: 600px; margin: 40px auto; padding: 20px; background-color: #fff; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">

    <!-- HL店長密碼區塊 -->
    <h2 style="text-align:center; margin-bottom:20px;">HL店長密碼</h2>

    <div style="text-align:center; margin-bottom: 20px;">
        <input type="number" id="inputNumber" placeholder="輸入店編後三碼" style="padding:10px; width:180px; border-radius:5px; border:1px solid #ccc;">
    </div>

    <div style="text-align:center; margin-bottom: 20px;">
        <button onclick="calculatePassword()" style="padding:10px 20px; font-size:18px; border:none; border-radius:5px; background-color:#20B2AA; color:white; cursor:pointer;">計算</button>
    </div>

    <div style="text-align:center; font-size:20px; font-weight:bold; color:#007BFF; margin-bottom:30px;">
        <span id="result">結果將顯示於此</span>
    </div>

    <!-- SOP 流程區塊 -->
    <div style="padding: 20px; background-color: #f9f9f9; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05);">
        <h2 style="text-align:center; margin-bottom:20px;">TM 解鎖流程 SOP</h2>
        <p>解鎖前兩台TM請關機</p>
        <ol>
            <li>開啟E網 &gt; 通訊設備類(下方方塊) &gt; 停復業查詢作業 &gt; 2.密碼查詢</li>
            <li>開啟部門網頁計算店長密碼</li>
            <li>回到E網 &gt; 請輸入店長密碼 : 後"確定" &gt; 按"TM[解鎖]密碼申請"</li>
            <li>複製解鎖驗證碼(紅字) &gt; 貼入輸入欄位 &gt; 確定</li>
            <li>複製"密碼號碼"欄位</li>
            <li>開啟HI_SHOP &gt; 門市通訊系統 &gt; 停復機作業 &gt; 輸入選項代號 = 2</li>
            <li>貼上第5步驟"密碼號碼"</li>
            <li>開啟TM1</li>
        </ol>
        <p>※ TM2請重複流程1-8，一組解鎖密碼僅供一台使用，同時開啟TM可能導致解鎖失敗</p>
    </div>

</div>
{% endblock %}

{% block extra_scripts %}
<script>
function calculatePassword() {
    const inputVal = parseInt(document.getElementById('inputNumber').value);
    if (isNaN(inputVal)) {
        alert("請輸入有效數字");
        return;
    }

    // 取得今天日期
    const today = new Date();
    const taiwanYear = today.getFullYear() - 1911; // 民國年
    const month = today.getMonth() + 1; // JS 月份 0~11

    // 計算公式
    let result = (inputVal * 1997) + 8800 + (taiwanYear * month);

    // 取最後四碼
    const last4 = ("0000" + (result % 10000)).slice(-4);

    document.getElementById('result').textContent = last4;
}
</script>
{% endblock %}
