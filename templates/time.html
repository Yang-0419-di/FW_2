{% extends "layout.html" %}

{% block content %}
<!-- === 出勤時間統計頁 time.html === -->

<div class="table">
  <h2 class="section-title">出勤時間曲線圖</h2>
  <div style="text-align: center;">
    <img src="data:image/png;base64,{{ plot_url }}" alt="出勤時間曲線圖" style="width: 1000px; height: auto;"/>
  </div>
</div>

<div class="table">
  <h2 class="section-title">總計</h2>
  <table class="dataframe attendance-table">
    <thead>
      <tr>
        {% for col in df_summary.columns %}
        <th class="{% if col == '狄澤洋' %}blue-bg{% elif col == '湯家瑋' %}orange-bg{% elif col == '吳宗鴻' %}green-bg{% endif %}">
          {{ col }}
        </th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for row in df_summary.values %}
      <tr>
        {% for cell in row %}
        {% set col = df_summary.columns[loop.index0] %}
        <td class="{% if col == '狄澤洋' %}blue-bg{% elif col == '湯家瑋' %}orange-bg{% elif col == '吳宗鴻' %}green-bg{% endif %}">
          {{ cell }}
        </td>
        {% endfor %}
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="table">
  <h2 class="section-title">萊爾富 Hi_Life</h2>
  {{ detail_table_1|safe }}
</div>

<div class="table">
  <h2 class="section-title">MFP&其他</h2>
  {{ detail_table_2|safe }}
</div>

<div class="table">
  <h2 class="section-title">合併統計</h2>
  {{ detail_table_3|safe }}
</div>

<style>
  .section-title {
    color: #333;
    margin-bottom: 10px;
  }
  .attendance-table {
    width: 100%;
    border-collapse: collapse;
  }
  .attendance-table th, .attendance-table td {
    border: 1px solid #ccc;
    padding: 10px;
    text-align: center;
    word-break: break-word;
  }
  .attendance-table th {
    background-color: #007BFF;
    color: white;
    position: sticky;
    top: 0;
    z-index: 1;
  }
  .blue-bg { background-color: lightblue; }
  .orange-bg { background-color: orange; }
  .green-bg { background-color: lightgreen; }
</style>

{% endblock %}
